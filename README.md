# TinyA5/1 Stream Cipher Visualizer

A comprehensive educational tool for understanding the TinyA5/1 stream cipher algorithm, featuring both a web-based visualizer and a command-line interface.

## Features

- **Web Interface**: Interactive visualization with step-by-step register operations
- **CLI Tool**: Terminal-based encryption/decryption with verbose mode
- **Dual Input Support**: Binary strings or character input (A-H)
- **Real-time Visualization**: Watch registers rotate and keystream generation
- **Educational Focus**: Clear display of algorithm internals

## Installation

### Prerequisites

- Python 3.7 or higher
- pip (Python package manager)

### Setup

1. **Clone or download the project files**

2. **Install dependencies**:
   ```bash
   pip install flask flask-cors
   ```

3. **Run the web application**:
   ```bash
   python app.py
   ```

4. **Open your browser** and navigate to `http://localhost:5000`

## Usage

### Web Interface

1. **Choose Input Format**:
   - **Binary**: Enter binary strings (e.g., "111")
   - **Characters**: Enter letters A-H (e.g., "H")

2. **Select Mode**:
   - **Immediate**: Get instant encryption/decryption results
   - **Step-by-step visualization**: Watch the algorithm execute step by step

3. **Enter Data**:
   - **Plaintext/Ciphertext**: Your data to encrypt/decrypt
   - **Key**: Exactly 23 bits (e.g., "10010101001110100110000")

4. **Visualization Controls** (in step-by-step mode):
   - **Previous/Next**: Navigate through steps manually
   - **Play/Pause**: Auto-play through all steps
   - **Register Display**: See X (6 bits), Y (8 bits), Z (9 bits) registers
   - **Control Bits**: Highlighted x2, y7, z8 positions
   - **Majority Function**: Shows maj(x2, y7, z8) calculation
   - **Rotations**: Visual indication of which registers rotate
   - **Keystream**: Shows s = x5 ⊕ y7 ⊕ z8 calculation
   - **Encryption**: Shows data ⊕ keystream = result

### Command Line Interface

#### Interactive Mode
```bash
python cli.py --interactive
```

#### Direct Commands

**Encrypt binary data**:
```bash
python cli.py --encrypt --data "111" --key "10010101001110100110000"
```

**Decrypt binary data**:
```bash
python cli.py --decrypt --data "011" --key "10010101001110100110000"
```

**Encrypt character data**:
```bash
python cli.py --encrypt --data "H" --key "10010101001110100110000" --char
```

**Verbose mode (show step-by-step)**:
```bash
python cli.py --encrypt --data "111" --key "10010101001110100110000" --verbose
```

## Algorithm Details

### TinyA5/1 Overview

TinyA5/1 is a simplified version of the A5/1 stream cipher used in GSM mobile phones. It features:

- **3 Registers**: X (6 bits), Y (8 bits), Z (9 bits)
- **23-bit Key**: Split across the three registers
- **Majority Function**: Determines which registers rotate
- **XOR Feedback**: Registers rotate with XOR feedback
- **Keystream**: Generated by XORing specific register bits

### Character Encoding

The system supports character input using this mapping:
- A → 000
- B → 001
- C → 010
- D → 011
- E → 100
- F → 101
- G → 110
- H → 111

### Algorithm Steps

1. **Initialize**: Load 23-bit key into registers X, Y, Z
2. **For each bit**:
   - Read control bits: x2, y7, z8
   - Calculate majority: maj(x2, y7, z8)
   - Rotate registers where control bit equals majority
   - Generate keystream bit: s = x5 ⊕ y7 ⊕ z8
   - XOR with data bit: cipher_bit = data_bit ⊕ s

## Examples

### Example 1: Encrypting "H" (111)

**Input**:
- Plaintext: "H" (binary: "111")
- Key: "10010101001110100110000"

**Process**:
1. Split key: X="100101", Y="01001110", Z="100110000"
2. Step 0: x2=0, y7=0, z8=1 → maj(0,0,1)=0 → rotate X,Y
3. Step 1: x2=1, y7=0, z8=1 → maj(1,0,1)=1 → rotate X,Z
4. Step 2: x2=1, y7=0, z8=0 → maj(1,0,0)=0 → rotate Y,Z
5. Generate keystream: "100"
6. Result: "111" ⊕ "100" = "011" (D)

### Example 2: Using CLI

```bash
# Encrypt "H" with verbose output
python cli.py --encrypt --data "H" --key "10010101001110100110000" --char --verbose

# Decrypt the result
python cli.py --decrypt --data "D" --key "10010101001110100110000" --char --verbose
```

## File Structure

```
TinyA51/
├── tinya51.py          # Core algorithm implementation
├── cli.py              # Command-line interface
├── app.py              # Flask web server
├── requirements.txt    # Python dependencies
├── README.md           # This file
├── templates/
│   └── index.html      # Web interface HTML
└── static/
    ├── style.css       # Web interface styles
    └── app.js          # Web interface JavaScript
```

## API Endpoints

The Flask backend provides these REST API endpoints:

- `POST /api/encrypt` - Encrypt plaintext
- `POST /api/decrypt` - Decrypt ciphertext
- `POST /api/validate` - Validate input data
- `POST /api/convert` - Convert between binary and character formats

## Troubleshooting

### Common Issues

1. **"Key must be exactly 23 bits"**
   - Ensure your key is exactly 23 characters long
   - Use only 0s and 1s

2. **"Data must contain only 0s and 1s"**
   - For binary mode, use only 0s and 1s
   - For character mode, use only A-H

3. **Web interface not loading**
   - Ensure Flask server is running (`python app.py`)
   - Check that port 5000 is available
   - Try `http://127.0.0.1:5000` instead of localhost

4. **"Module not found" errors**
   - Install dependencies: `pip install flask flask-cors`
   - Ensure you're in the correct directory

### Getting Help

- Check the console output for error messages
- Use `--verbose` flag in CLI for detailed step information
- Web interface shows validation errors in real-time

## Educational Value

This tool is designed for educational purposes to help understand:

- Stream cipher operation
- Register-based keystream generation
- Majority function logic
- XOR-based encryption
- Step-by-step algorithm execution

Perfect for cryptography students, security professionals, and anyone interested in understanding how stream ciphers work.

## License

This project is for educational purposes. Feel free to use and modify for learning about cryptography.
