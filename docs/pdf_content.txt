3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ A5/1
Giá»›i thiá»‡u: 
Â¡ A5/1 Ä‘Æ°á»£c dÃ¹ng trong máº¡ng Ä‘iá»‡n thoáº¡i GSM, Ä‘á»ƒ báº£o máº­t dá»¯ liá»‡u trong quÃ¡ trÃ¬nh 
liÃªn láº¡c giá»¯a mÃ¡y tÃ­nh Ä‘iá»‡n thoáº¡i vÃ  tráº¡m thu phÃ¡t sÃ³ng vÃ´ tuyáº¿n
Â¡ ÄÆ¡n vá»‹ mÃ£ hoÃ¡ cá»§a A5/1 lÃ  1 bÃ­t. Bá»™ sinh sá»‘ má»—i láº§n sáº½ sinh ra hoáº·c bÃ­t 0 hoáº·c bÃ­t 
1 Ä‘á»ƒ sá»­ dá»¥ng trong phÃ©p XOR
Ã Trong bÃ i há»c giá»›i háº¡n xÃ©t mÃ´ hÃ¬nh thu nhá» cá»§a A5/1, gá»i táº¯t lÃ  TinyA5/1
38

3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ TinyA5/1
Â¡ Bá»™ sinh sá»‘ gá»“m 3 thanh ghi X, Y, Z:
Â¡
X gá»“m 6 bÃ­t (x!, x", â€¦ , x&)
Â¡
Y gá»“m 8 bÃ­t (y!, y", â€¦ , y')
Â¡
Z gá»“m 9 bÃ­t (z!, z", â€¦ , z()
Â¡ KhoÃ¡ K cÃ³ chiá»u dÃ i 23 bÃ­t lÃ  Ä‘Æ°á»£c phÃ¢n bá»• vÃ o cÃ¡c thanh ghi: K âŸ¶ XYZ
Â¡ CÃ¡c thanh ghi X, Y, Z Ä‘Æ°á»£c biáº¿n Ä‘á»•i theo cÃ¡c quy táº¯c quay
39

3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ TinyA5/1
Â¡ Äáº§u vÃ o: P, K
Â¡ Ná»™i dung thuáº­t toÃ¡n:
Â¡ Äáº§u ra: C
PhÃ¢n bá»• K vÃ o cÃ¡c thanh ghi XYZ
Táº¡i bÆ°á»›c sinh sá»‘ thá»© i, thá»±c hiá»‡n cÃ¡c phÃ©p tÃ­nh:
TÃ­nh m = maj(x", y', z') lÃ  â€hÃ m chiáº¿m Ä‘a sá»‘â€. Náº¿u trong 3 bÃ­t x", y', z' cÃ³ tá»« 
hai bÃ­t 0 trá»Ÿ lÃªn thÃ¬ hÃ m tráº£ vá» giÃ¡ trá»‹ 0; NgÆ°á»£c láº¡i, hÃ m tráº£ vá» giÃ¡ trá»‹ 1.
Kiá»ƒm tra:
Náº¿u x" = m thÃ¬ thá»±c hiá»‡n Quay X;
Náº¿u y' = m thÃ¬ thá»±c hiá»‡n Quay Y;
Náº¿u z' = m thÃ¬ thá»±c hiá»‡n Quay Z;
TÃ­nh s& = x( â¨ y)â¨z*
Báº£n mÃ£ C = P ğ—ğğ‘ S
40

3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ TinyA5/1
Â¡ Quay X gá»“m cÃ¡c thao tÃ¡c:
Â¡ t = x% â¨ x) â¨ x&
Â¡ x* = x*$" vá»›i j = 5, 4, 3, 2, 1
Â¡ x! = t
1
0
0
1
0
1
0
1
2
3
4
5
t = 0 â¨0 â¨1 = 1
1
1
0
0
1
0
Â¡ Quay Y gá»“m cÃ¡c thao tÃ¡c:
Â¡
t = y+ â¨ y'
Â¡
y* = y*$" vá»›i j = 7, 6, â€¦ , 1
Â¡
y! = t
ğ—
0
1
0
0
1
1
1
0
0
1
2
3
4
5
6
7
t = 0 â¨1 = 1
ğ˜
1
0
1
0
0
1
1
1
Â¡ Quay Z gá»“m cÃ¡c thao tÃ¡c:
Â¡
t = z% â¨ z' â¨ z(
Â¡
z* = z*$" vá»›i j = 8, 7, â€¦ , 1
Â¡
z! = t
1
0
0
1
1
0
0
0
0
0
1
2
3
4
5
6
7
8
t = 0 â¨0 â¨0 = 0
ğ™
0
1
0
0
1
1
0
0
0
41

3.1 â€“ MÃƒ DÃ’NG
Â¡ BÃ i táº­p: Cho báº£n rÃµ P = 111 (chá»¯ H), khoÃ¡ K = 10010101001110100110000
X
100101
Y
01001110
Z
100110000
Â¡ BÆ°á»›c 0: x" = 0, y' = 0, z' = 1 â†’ m = maj(0,0,1) = 0 â†’ quay X, quay Y  
100101
110010
X
01001110
10100111
Y
100110000
Z
s! = 0 â¨ 1 â¨ 0=1
Â¡ BÆ°á»›c 1: x" = 1, y' = 0, z' = 1 â†’ m = maj 1,0,1 = 1 â†’ quay X, quay Z  
110010
111001
X
100110000
010011000
Z
10100111
Y
s" = 1 â¨ 1 â¨ 0=0
PhÃ¢n bá»•
Â¡ Há»‡ mÃ£ TinyA5/1
Â¡ BÆ°á»›c 2: x" = 1, y' = 0, z' = 0 â†’ m = maj(1,0,0) = 0 â†’ quay Y, quay Z  
(CÃ²n tiáº¿p)
42

3.1 â€“ MÃƒ DÃ’NG
Â¡ BÆ°á»›c 2: x" = 1, y' = 0, z' = 0 â†’ m = maj 1,0,0 = 0 â†’ quay Y, quay Z  
10100111
01010011
Y
010011000
101001100
Z
111001
X
s% = 1 â¨ 1 â¨ 0=0
Â¡ Váº­y báº£n mÃ£ lÃ  C = 111 â¨ 100 = 011 (chá»¯ D)
Â¡ Giáº£i mÃ£: P = C â¨ S = 011 â¨ 100 = 111 
Â¡ BÃ i táº­p: Cho báº£n rÃµ P = 111 (chá»¯ H), khoÃ¡ K = 10010101001110100110000
X
100101
Y
01001110
Z
100110000
PhÃ¢n bá»•
Â¡ Há»‡ mÃ£ TinyA5/1
43

3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ A5/1 (Tá»•ng quÃ¡t)
Â¡ Äáº·c Ä‘iá»ƒm: NguyÃªn táº¯c bá»™ sá»‘ A5/1 hoáº¡t Ä‘á»™ng giá»‘ng TinyA5/1 nhÆ°ng kÃ­ch thÆ°á»›c 
thanh ghi X, Y, Z lÃ  19, 22 vÃ  23 bÃ­t
Â¡ HÃ m maj Ä‘Æ°á»£c tÃ­nh trÃªn 3 bÃ­t: m = maj(x*, y"!, z"!)
Â¡ Quay X, Y, Z vá»›i cÃ¡c bÃ­t nhÆ° sau:
Â¡ Sau khi quay bÃ­t xong thÃ¬ bÃ­t sinh ra: s& = x* â¨ y"!â¨z"!  
Â¡ A5/1 Ä‘Æ°á»£c thá»±c hiá»‡n dá»… dÃ ng báº±ng cÃ¡c thiáº¿t bá»‹ pháº§n cá»©ng, tá»‘c Ä‘á»™ nhanh
Â¡ Quay X :
Â¡
t = x", â¨ x"+ â¨ x"', â¨ x"(
Â¡
x* = x*$" vá»›i j = 18, 17, â€¦ , 1
Â¡
x! = t
Â¡ Quay Y:
Â¡
t = y%! â¨ y%"
Â¡
y* = y*$" vá»›i j = 21, 20, â€¦ , 1
Â¡
y! = t
Â¡ Quay Z:
Â¡
t = z' â¨ z%! â¨ z%"â¨ z%%
Â¡
z* = z*$" vá»›i j = 22, 21, â€¦ , 1
Â¡
z! = t
44

3.1 â€“ MÃƒ DÃ’NG
Â¡ Há»‡ mÃ£ A5/1 (Tá»•ng quÃ¡t)
Â¡ Äáº·c Ä‘iá»ƒm: NguyÃªn táº¯c bá»™ sá»‘ A5/1 hoáº¡t Ä‘á»™ng giá»‘ng TinyA5/1 nhÆ°ng kÃ­ch thÆ°á»›c 
thanh ghi X, Y, Z lÃ  19, 22 vÃ  23 bÃ­t
Â¡ HÃ m maj Ä‘Æ°á»£c tÃ­nh trÃªn 3 bÃ­t: m = maj(x*, y"!, z"!)
Â¡ Quay X, Y, Z vá»›i cÃ¡c bÃ­t nhÆ° sau:
Â¡ Sau khi quay bÃ­t xong thÃ¬ bÃ­t sinh ra: s& = x* â¨ y"!â¨z"!  
Â¡ A5/1 Ä‘Æ°á»£c thá»±c hiá»‡n dá»… dÃ ng báº±ng cÃ¡c thiáº¿t bá»‹ pháº§n cá»©ng, tá»‘c Ä‘á»™ nhanh
Â¡ Quay X :
Â¡
t = x", â¨ x"+ â¨ x"', â¨ x"(
Â¡
x* = x*$" vá»›i j = 18, 17, â€¦ , 1
Â¡
x! = t
Â¡ Quay Y:
Â¡
t = y%! â¨ y%"
Â¡
y* = y*$" vá»›i j = 21, 20, â€¦ , 1
Â¡
y! = t
Â¡ Quay Z:
Â¡
t = z' â¨ z%! â¨ z%"â¨ z%%
Â¡
z* = z*$" vá»›i j = 22, 21, â€¦ , 1
Â¡
z! = t
45